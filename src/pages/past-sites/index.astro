---
import InnerLayout from '../../layouts/InnerLayout.astro'
import { getPastArchives } from '../../lib/past-archives'

const archivesAscending = await getPastArchives()
const archivesDescending = [...archivesAscending].reverse()
const canonicalURL = new URL(Astro.url.pathname, Astro.site)
---

<InnerLayout
  subtitle="A complete timeline of my older site versions."
  meta={{
    title: 'Past Websites by Frank Stallone',
    description: 'Browse archived versions of frankstall.one across the years.',
    canonicalURL: canonicalURL.href,
  }}
>
  <section class="region wrapper flow" id="main">
    <h2 class="mt-zero">Past Website Archives</h2>
    <p>
      These are preserved snapshots of older versions of my site. Open any one
      and use the floating dock in the bottom-right corner to move to the next
      or previous archive.
    </p>
    <p class="text-step-00 text-gray-1100">
      Shortcut keys inside archives: <code>[</code> for previous, <code>]</code>
      for next.
    </p>
    {
      archivesDescending.length ? (
        <ol class="past-index-grid" role="list">
          {archivesDescending.map((archive, index) => (
            <li class="past-index-card flow flow-space-2xs">
              <p class="past-index-kicker text-step-00">
                {index === 0 ? 'Most recent archive' : 'Archive snapshot'}
              </p>
              <h3 class="mt-zero">Site {archive.slug}</h3>
              <p class="text-step-00 text-gray-1200">
                Open this snapshot exactly as it shipped, with non-destructive
                archive navigation controls layered on top.
              </p>
              <p class="mt-2xs">
                <a href={`/past/${archive.slug}/`}>Open Site {archive.slug}</a>
              </p>
            </li>
          ))}
        </ol>
      ) : (
        <p>No archives were found in <code>public/past</code>.</p>
      )
    }
  </section>
</InnerLayout>

<style>
  .past-index-grid {
    list-style: none;
    padding: 0;
    margin: var(--space-m) 0 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: var(--space-s);
  }

  .past-index-card {
    border: 1px solid #d1d5db;
    border-radius: 0.75rem;
    background: linear-gradient(180deg, #f4f4f5, #ffffff);
    padding: var(--space-s);
  }

  .past-index-kicker {
    margin: 0;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    font-weight: 600;
  }
</style>
