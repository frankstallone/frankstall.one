/* 
POST block layout using container queries
Inspired by: https://piccalil.li/blog/building-a-breakout-element-with-container-units/
*/

.post {
  /* Configure sidebar composition via custom properties */
  --sidebar-content-min-width: 60%;
  --sidebar-target-width: clamp(16rem, 30cqi, 30rem);
  --gutter: var(--space-xl);
  --post-sidebar-border-color: #676cc8; /* Indigo 600 */
  /* Threshold at which we consider the layout wide enough to place the sidebar inline */
  --post-inline-threshold: 52rem;

  /* Enable container queries & units */
  container-type: inline-size;
}

/* Flip the visual order (sidebar on right) only when the container is wide enough.
   Keep sidebar first in DOM so that when stacked it appears above content. */
@container (min-width: var(--post-inline-threshold, 52rem)) {
  /* Ensure content is on the left and sidebar on the right when inline */
  .post .post__content {
    order: 1;
  }
  .post .post__sidebar {
    order: 2;
  }
}

/* Optional: breakout element support inside the post */
.post__breakout {
  width: 100cqi;
}

/* Sidebar border: bottom when stacked (sidebar on top) */
.post .post__sidebar {
  border: 0;
  border-block-end: 2px solid var(--post-sidebar-border-color);
}

/* Sidebar border: left when inline (sidebar on right); remove bottom */
@container (min-width: var(--post-inline-threshold, 52rem)) {
  .post .post__sidebar {
    border-block-end: 0;
    border-inline-start: 2px solid var(--post-sidebar-border-color);
  }
}
